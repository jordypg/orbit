(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[706],{7886:function(e,s,t){Promise.resolve().then(t.bind(t,6852))},9294:function(e,s,t){"use strict";t.d(s,{S:function(){return x},TRPCProvider:function(){return m}});var l=t(7437),n=t(3160),a=t(9693),d=t(2899),i=t(8594),r=t(2265),c=t(8080);t(257);let x=(0,i.ec)();function m(e){let{children:s}=e,[t]=(0,r.useState)(()=>new n.S({defaultOptions:{queries:{staleTime:5e3,refetchOnWindowFocus:!1}}})),[i]=(0,r.useState)(()=>x.createClient({transformer:c.ZP,links:[(0,d.gb)({enabled:e=>"down"===e.direction&&e.result instanceof Error}),(0,d.N8)({url:"".concat("","/api/trpc")})]}));return(0,l.jsx)(x.Provider,{client:i,queryClient:t,children:(0,l.jsx)(a.aH,{client:t,children:s})})}},6852:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return u}});var l=t(7437),n=t(9294),a=t(4401),d=t(2934);let i=(0,t(9205).Z)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var r=t(7168),c=t(1817),x=t(1723),m=t(9388),o=t(8940);function u(){let{data:e,isLoading:s}=n.S.worker.stats.useQuery(void 0,{refetchInterval:5e3}),{data:t,isLoading:u}=n.S.worker.health.useQuery(void 0,{refetchInterval:5e3}),{data:h}=n.S.worker.recentRuns.useQuery({limit:10,status:"pending"},{refetchInterval:5e3}),{data:j}=n.S.worker.recentRuns.useQuery({limit:10,status:"running"},{refetchInterval:5e3}),{data:v}=n.S.worker.recentRuns.useQuery({limit:15},{refetchInterval:5e3});return(0,l.jsxs)("main",{className:"min-h-screen bg-background",children:[(0,l.jsx)("header",{className:"border-b",children:(0,l.jsxs)("div",{className:"container mx-auto px-4 py-6",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,l.jsx)(a.Z,{className:"h-8 w-8"}),(0,l.jsx)("h1",{className:"text-3xl font-bold",children:"Worker Monitor"}),(0,l.jsx)(r.Z,{className:"h-5 w-5 text-muted-foreground animate-spin ml-auto"})]}),(0,l.jsx)("p",{className:"text-muted-foreground",children:"Real-time worker status and pipeline execution monitoring"})]})}),(0,l.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Worker Health"}),(0,l.jsx)("div",{className:"rounded-lg border p-6",children:u?(0,l.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,l.jsx)(c.Z,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):(0,l.jsxs)("div",{className:"flex items-center gap-4",children:[(0,l.jsx)("div",{className:"p-3 rounded-full ".concat((()=>{if(!t)return"bg-gray-500";switch(t.status){case"healthy":return"bg-green-500";case"warning":return"bg-yellow-500";default:return"bg-gray-500"}})()," text-white"),children:(()=>{if(!t)return(0,l.jsx)(a.Z,{className:"h-5 w-5"});switch(t.status){case"healthy":return(0,l.jsx)(d.Z,{className:"h-5 w-5"});case"warning":return(0,l.jsx)(i,{className:"h-5 w-5"});default:return(0,l.jsx)(a.Z,{className:"h-5 w-5"})}})()}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("div",{className:"flex items-center gap-2",children:(0,l.jsxs)("h3",{className:"font-semibold text-lg",children:[(null==t?void 0:t.status)==="healthy"&&"Worker is Healthy",(null==t?void 0:t.status)==="warning"&&"Worker Warning"]})}),(0,l.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:null==t?void 0:t.message}),(null==t?void 0:t.lastActivity)&&(0,l.jsxs)("p",{className:"text-xs text-muted-foreground mt-2",children:["Last activity: ",(0,o.Q)(new Date(t.lastActivity),{addSuffix:!0})]})]}),(null==t?void 0:t.stuckRuns)>0&&(0,l.jsxs)("div",{className:"text-right",children:[(0,l.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:null==t?void 0:t.stuckRuns}),(0,l.jsx)("div",{className:"text-xs text-muted-foreground",children:"Stuck Runs"})]})]})})]}),(0,l.jsxs)("div",{className:"mb-8",children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Metrics"}),(0,l.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,l.jsxs)("div",{className:"rounded-lg border p-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsx)(x.Z,{className:"h-5 w-5 text-yellow-600"}),(0,l.jsx)("span",{className:"text-2xl font-bold",children:s?"-":(null==e?void 0:e.pending)||0})]}),(0,l.jsx)("div",{className:"text-sm font-medium",children:"Pending"}),(0,l.jsx)("div",{className:"text-xs text-muted-foreground",children:"Waiting to run"})]}),(0,l.jsxs)("div",{className:"rounded-lg border p-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsx)(r.Z,{className:"h-5 w-5 text-blue-600"}),(0,l.jsx)("span",{className:"text-2xl font-bold",children:s?"-":(null==e?void 0:e.running)||0})]}),(0,l.jsx)("div",{className:"text-sm font-medium",children:"Running"}),(0,l.jsx)("div",{className:"text-xs text-muted-foreground",children:"Currently executing"})]}),(0,l.jsxs)("div",{className:"rounded-lg border p-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsx)(a.Z,{className:"h-5 w-5 text-purple-600"}),(0,l.jsx)("span",{className:"text-2xl font-bold",children:s?"-":(null==e?void 0:e.runsLastHour)||0})]}),(0,l.jsx)("div",{className:"text-sm font-medium",children:"Last Hour"}),(0,l.jsx)("div",{className:"text-xs text-muted-foreground",children:"Runs executed"})]}),(0,l.jsxs)("div",{className:"rounded-lg border p-6",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,l.jsx)(m.Z,{className:"h-5 w-5 text-red-600"}),(0,l.jsx)("span",{className:"text-2xl font-bold",children:s?"-":"".concat((null==e?void 0:e.errorRate)||0,"%")})]}),(0,l.jsx)("div",{className:"text-sm font-medium",children:"Error Rate"}),(0,l.jsx)("div",{className:"text-xs text-muted-foreground",children:"Last 24 hours"})]})]}),(0,l.jsxs)("div",{className:"grid gap-4 md:grid-cols-3 mt-4",children:[(0,l.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,l.jsx)("div",{className:"text-sm text-muted-foreground",children:"Avg Duration"}),(0,l.jsx)("div",{className:"text-xl font-semibold mt-1",children:s?"-":"".concat((((null==e?void 0:e.avgDurationMs)||0)/1e3).toFixed(2),"s")})]}),(0,l.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,l.jsx)("div",{className:"text-sm text-muted-foreground",children:"24h Success"}),(0,l.jsx)("div",{className:"text-xl font-semibold mt-1 text-green-600",children:s?"-":(null==e?void 0:e.successCount)||0})]}),(0,l.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,l.jsx)("div",{className:"text-sm text-muted-foreground",children:"24h Failed"}),(0,l.jsx)("div",{className:"text-xl font-semibold mt-1 text-red-600",children:s?"-":(null==e?void 0:e.failedCount)||0})]})]})]}),(0,l.jsxs)("div",{className:"grid gap-8 lg:grid-cols-2 mb-8",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Pending Queue"}),(0,l.jsx)("div",{className:"rounded-lg border",children:h&&0!==h.length?(0,l.jsx)("div",{className:"divide-y",children:h.map(e=>(0,l.jsx)("div",{className:"p-4 hover:bg-muted/50 transition-colors",children:(0,l.jsxs)("div",{className:"flex items-start justify-between",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("div",{className:"font-medium",children:e.pipeline.name}),(0,l.jsxs)("div",{className:"text-sm text-muted-foreground mt-1",children:[e.steps.length," steps"]})]}),(0,l.jsx)("div",{className:"text-xs text-muted-foreground text-right",children:(0,o.Q)(new Date(e.startedAt),{addSuffix:!0})})]})},e.id))}):(0,l.jsxs)("div",{className:"p-8 text-center text-muted-foreground",children:[(0,l.jsx)(x.Z,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),(0,l.jsx)("p",{children:"No pending runs"})]})})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Currently Running"}),(0,l.jsx)("div",{className:"rounded-lg border",children:j&&0!==j.length?(0,l.jsx)("div",{className:"divide-y",children:j.map(e=>(0,l.jsx)("div",{className:"p-4 hover:bg-muted/50 transition-colors",children:(0,l.jsxs)("div",{className:"flex items-start justify-between",children:[(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("div",{className:"font-medium",children:e.pipeline.name}),(0,l.jsxs)("div",{className:"text-sm text-muted-foreground mt-1",children:[e.steps.filter(e=>"completed"===e.status).length," / ",e.steps.length," steps"]}),(0,l.jsx)("div",{className:"w-full bg-muted rounded-full h-1.5 mt-2",children:(0,l.jsx)("div",{className:"bg-blue-600 h-1.5 rounded-full transition-all",style:{width:"".concat(e.steps.filter(e=>"completed"===e.status).length/e.steps.length*100,"%")}})})]}),(0,l.jsx)("div",{className:"text-xs text-muted-foreground text-right ml-4",children:(0,o.Q)(new Date(e.startedAt),{addSuffix:!0})})]})},e.id))}):(0,l.jsxs)("div",{className:"p-8 text-center text-muted-foreground",children:[(0,l.jsx)(r.Z,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),(0,l.jsx)("p",{children:"No running runs"})]})})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Recent Activity"}),(0,l.jsx)("div",{className:"rounded-lg border",children:v&&0!==v.length?(0,l.jsx)("div",{className:"divide-y",children:v.map(e=>(0,l.jsx)("div",{className:"p-4 hover:bg-muted/50 transition-colors",children:(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,l.jsxs)("div",{children:["success"===e.status&&(0,l.jsx)(d.Z,{className:"h-5 w-5 text-green-600"}),"failed"===e.status&&(0,l.jsx)(m.Z,{className:"h-5 w-5 text-red-600"}),"running"===e.status&&(0,l.jsx)(r.Z,{className:"h-5 w-5 text-blue-600 animate-spin"}),"pending"===e.status&&(0,l.jsx)(x.Z,{className:"h-5 w-5 text-yellow-600"})]}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("div",{className:"font-medium",children:e.pipeline.name}),(0,l.jsxs)("div",{className:"text-sm text-muted-foreground",children:[e.steps.length," steps",e.finishedAt&&e.startedAt&&(0,l.jsxs)("span",{className:"ml-2",children:["â€¢ ",((new Date(e.finishedAt).getTime()-new Date(e.startedAt).getTime())/1e3).toFixed(2),"s"]})]})]})]}),(0,l.jsx)("div",{className:"text-xs text-muted-foreground",children:(0,o.Q)(new Date(e.startedAt),{addSuffix:!0})})]})},e.id))}):(0,l.jsxs)("div",{className:"p-8 text-center text-muted-foreground",children:[(0,l.jsx)(a.Z,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),(0,l.jsx)("p",{children:"No recent activity"})]})})]})]})]})}},4401:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});let l=(0,t(9205).Z)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},7168:function(e,s,t){"use strict";t.d(s,{Z:function(){return l}});let l=(0,t(9205).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])}},function(e){e.O(0,[632,446,971,117,744],function(){return e(e.s=7886)}),_N_E=e.O()}]);